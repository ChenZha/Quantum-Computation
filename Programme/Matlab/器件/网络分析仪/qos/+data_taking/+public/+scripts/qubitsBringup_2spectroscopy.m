% bring up qubits - spectroscopy
% Yulin Wu, 2017/3/11
%%
% qubits = {'q2','q4','q5','q6','q8','q9','q10','q12'};%'q1','q2','q3','q4','q5','q6','q7','q8','q9','q10','q11','q12'
for ii = [9:12]%3:numel(qubits)
    q = qubits{ii};
    setQSettings('r_avg',1000);
    f01 = getQSettings('f01',q);
    freq = f01-10e6:1e6:f01+10e6;
%     freq = 4.9e9:2e6:5.3e9;
    biasAmp = [0:1e4:3e4];
    spectroscopy1_zpa('qubit',q,'biasAmp',biasAmp,'driveFreq',[freq],...
        'dataTyp','P','gui',true,'save',true);
end
%%
q = 'q2';
setQSettings('r_avg',500);
freq = 4.1e9:2e6:4.6e9;
biasAmp = 1e4;
spectroscopy1_zpa('qubit',q,'biasAmp',biasAmp,'driveFreq',[freq],...
    'dataTyp','S21','gui',true,'save',true,'notes','xydrive=2dBm');
%%
q = 'q2';
setQSettings('r_avg',500);
f01 = getQSettings('f01',q);
freq = 4.5e9:3e6:4.7e9;
% freq = 4.4e9:1e6:4.7e9;
zdcamp = getQSettings('zdc_amp',q);
biasamp = -9e4;
% biasamp = zdcamp;
spectroscopy1_zdc('qubit',q,'biasAmp',biasamp,'driveFreq',[freq],...
       'updateReadoutFreq',true,'dataTyp','S21','gui',true,'save',true); % dataTyp: S21 or P
% spectroscopy1_zpa('qubit','q2'); % lazy mode
%%
spectroscopy1_power('qubit','q7',...
       'biasAmp',0,'driveFreq',[4.75e9:0.2e6:5.4e9],...
       'uSrcPower',[5:1:20],...
       'dataTyp','P','gui',true,'save',true); % dataTyp: S21 or P
%% zpls cross talk
biasQ = 'q2';
targetQ = 'q3';
f01 = getQSettings('f01',targetQ);
freq = f01-10e6:1e6:f01+3e6;
spectroscopy111_zpa('biasQubit',biasQ,'biasAmp',[-20000:10000:30000],... 
       'driveQubit',targetQ,'driveFreq',[freq],...
       'readoutQubit',targetQ,'dataTyp','P',...
       'notes',[biasQ,'->',targetQ,' zpls cross talk'],'gui',true,'save',true);
%%
setQSettings('r_avg',500);
spectroscopy_zpa_withPi('qubit','q2','biasAmp',[2.4287e+04],...
'driveFreq',[4.04e9 - 80e6: 6e6: 4.04e9 + 80e6],...
'driveDelay',50,'zLength',200,...
'notes','','gui',true,'save','');
%%
temp.spectroscopy_zpa_withPi_driveDelay('qubit','q6','biasAmp',2.4287e+04,...
      'driveFreq',[4e9],...
      'driveDelay',[-200:100:600],'zLength',200,...
      'notes','','gui',true,'save',true);
%%
setQSettings('r_avg',500);
% pf01 = [-0.55133,188.64,5.175e9];
% q9zAmp2f01 = @(x) polyval(pf01,x);
pf01 = [-0.546353162572338,-34236.1057095769,4122653376.87291];
q7zAmp2f01 = @(x) polyval(pf01,x);
% pf01 = [-0.33858,-16646,4.566e+09];
% q6zAmp2f01 = @(x) polyval(pf01,x);
spectroscopy1_zpa_bndSwp('qubit','q2',...
       'swpBandCenterFcn',q7zAmp2f01,'swpBandWdth',10e6,...
       'biasAmp',[-3e4:100:0],'driveFreq',[4.1e9:1e6:4.7e9],...
       'gui',true,'save',true);
% spectroscopy1_zpa_bndSwp('qubit','q2',...
%        'swpBandCenterFcn',q2zAmp2f01,'swpBandWdth',120e6,...
%        'biasAmp',[6000:50:9750],'driveFreq',[5.56e9:0.2e6:5.77e9],...
%        'gui',false,'save',true);
%%
for ii=[2]
setQSettings('r_avg',1000);
spectroscopy1_zpa_auto('qubit',qubits{ii},'biasAmp',-1.5e4:500:1.5e4,...
    'swpInitf01',[],'swpInitBias',[0],...
    'swpBandWdth',25e6,'swpBandStep',1e6,...
    'dataTyp','P','gui',true);
end
%%
for ii=3
setQSettings('r_avg',1000);
spectroscopy1_zdc_auto('qubit',qubits{ii},'biasAmp',3.21e5:1e3:4e5,...
    'swpInitf01',[],'swpInitBias',sqc.util.getQSettings('zdc_amp',qubits{ii}),...
    'swpBandWdth',25e6,'swpBandStep',1e6,...
    'dataTyp','S21','gui',true);
end
%%
f21('qubit',q,'ahFreq',[-235e6:-0.15e6:-255e6],'sbFreq',-400e6,...
      'notes','','gui',true,'save',true);
